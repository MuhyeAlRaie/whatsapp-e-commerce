<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>متجر إلكتروني بسيط</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <style>
    .hero {
      background: url('https://via.placeholder.com/1920x600') center/cover no-repeat;
      color: white;
      text-align: center;
      padding: 100px 20px;
    }
    .product-card img {
      height: 200px;
      object-fit: cover;
    }
     .product-popup, .checkout-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border: 1px solid #ccc;
      padding: 20px;
      z-index: 1050;
      width: 400px;
      display: none;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
     .cart-popup {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      border: 1px solid #ccc;
      padding: 15px;
      z-index: 1000;
      width: 300px;
      display: none;
    }
    .filter-buttons .btn {
      margin-left: 10px;
    }
    .product-popup img {
      width: 100%;
      height: auto;
      margin-bottom: 10px;
    }
    #map {
      height: 300px;
      width: 100%;
      margin-bottom: 10px;
    }
    #location-error {
      color: red;
      font-size: 0.9em;
      margin-top: -10px;
      margin-bottom: 10px;
      display: none;
    }
  </style>
</head>
<body>
<!-- الهيدر -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="container">
    <a class="navbar-brand" href="#"><img src="https://via.placeholder.com/100x40" alt="الشعار"></a>
    <div class="me-auto">
      <button class="btn btn-outline-primary" onclick="toggleCartPopup()">
        🛒 <span id="cart-count">0</span>
      </button>
    </div>
  </div>
</nav>
<!-- البانر -->
<section class="hero">
  <h1>مرحباً بكم في متجرنا</h1>
  <p>اكتشف منتجاتنا المميزة</p>
</section>
<!-- الفلاتر -->
<div class="container my-4 d-flex align-items-center justify-content-end">
  <input id="searchInput" type="text" class="form-control w-25 ms-3" placeholder="ابحث عن منتج..." oninput="displayProducts()">
  <div class="filter-buttons">
    <button class="btn btn-outline-dark" onclick="setFilter('all')">الكل</button>
    <button class="btn btn-outline-dark" onclick="setFilter('electronics')">إلكترونيات</button>
    <button class="btn btn-outline-dark" onclick="setFilter('fashion')">ملابس</button>
  </div>
</div>
<!-- المنتجات -->
<div class="container">
  <div id="products" class="row g-4"></div>
</div>
<!-- السلة -->
<div id="cart-popup" class="cart-popup">
  <h5>سلة المشتريات</h5>
  <ul id="cart-items" class="list-group mb-2" style="max-height: 250px; overflow-y: auto;"></ul>
  <!-- <div class="d-flex justify-content-between fw-bold mb-2">
    <span>الإجمالي:</span>
    <span id="cart-total">0 د.أ</span>
  </div> -->
  <button class="btn btn-success w-100" onclick="showCheckoutPopup()">إتمام الشراء</button>
</div>
<!-- تفاصيل المنتج -->
<div id="product-popup" class="product-popup">
  <h5 id="popup-title"></h5>
  <div id="popup-images"></div>
  <p id="popup-description"></p>
  <p><strong id="popup-price"></strong></p>
  <button class="btn btn-primary" onclick="addToCartFromPopup()">أضف إلى السلة</button>
  <button class="btn btn-secondary mt-2 w-100" onclick="closePopup('product-popup')">إغلاق</button>
</div>
<!-- إتمام الطلب -->
<div id="checkout-popup" class="checkout-popup">
  <h5>إتمام الطلب</h5>
  <input id="name" type="text" class="form-control mb-2" placeholder="الاسم">
  <input id="phone" type="text" class="form-control mb-2" placeholder="رقم الهاتف">
  <input id="address" type="text" class="form-control mb-2" placeholder="العنوان">
  <!-- <button class="btn btn-sm btn-outline-secondary mb-2" onclick="getUserLocation()">استخدم موقعي الحالي</button> -->
  <!-- <div id="location-error">⚠️ لم نتمكن من الحصول على موقعك. تأكد من السماح للموقع في إعدادات المتصفح.</div> -->
  <select id="payment" class="form-select mb-3">
    <option value="cash">نقداً</option>
    <option value="CliQ">CliQ</option>
  </select>
  <button class="btn btn-success w-100" onclick="submitOrder()">تأكيد الطلب</button>
  <button class="btn btn-secondary mt-2 w-100" onclick="closePopup('checkout-popup')">إلغاء</button>
</div>
<!-- الفوتر -->
<footer class="bg-light text-center mt-5 py-4">
  <div>
    <strong>الشعار</strong><br>
    &copy; 2025 جميع الحقوق محفوظة<br>
    البريد الإلكتروني: info@brand.com<br>
    الهاتف: +962-7-1234-5678
  </div>
</footer>
<script>
  const products = [
    {
      id: 1,
      name: 'هاتف ذكي',
      category: 'electronics',
      price: 299,
      oldPrice: 399,
      shortDesc: 'هاتف بسعة 128GB.',
      description: 'هاتف ذكي بأحدث التقنيات، كاميرا عالية الدقة، وبطارية تدوم طويلاً.',
      images: ['https://via.placeholder.com/400x250?text=هاتف+1', 'https://via.placeholder.com/400x250?text=هاتف+2']
    },
    {
      id: 2,
      name: 'تيشيرت',
      category: 'fashion',
      price: 25,
      oldPrice: 35,
      shortDesc: 'تيشيرت قطن مريح.',
      description: 'تيشيرت مصنوع من القطن الطبيعي 100%، مناسب لجميع المناسبات.',
      images: ['https://via.placeholder.com/400x250?text=تيشيرت+1']
    },
    {
      id: 3,
      name: 'سماعات رأس',
      category: 'electronics',
      price: 59,
      oldPrice: 89,
      shortDesc: 'سماعات مانعة للضوضاء.',
      description: 'سماعات عالية الجودة مانعة للضوضاء ومناسبة للاستخدام المطول.',
      images: ['https://via.placeholder.com/400x250?text=سماعات+1', 'https://via.placeholder.com/400x250?text=سماعات+2']
    }
  ];

  const cart = [];
  let currentProduct = null;
  let currentFilter = 'all';

  function displayProducts() {
    const container = document.getElementById('products');
    container.innerHTML = '';
    const search = document.getElementById('searchInput').value.toLowerCase();
    const filtered = products.filter(p => (currentFilter === 'all' || p.category === currentFilter) && p.name.toLowerCase().includes(search));
    filtered.forEach(product => {
      const card = document.createElement('div');
      card.className = 'col-md-4';
      card.innerHTML = `
        <div class="card product-card">
          <img src="${product.images[0]}" class="card-img-top" alt="${product.name}">
          <div class="card-body">
            <h5 class="card-title">${product.name}</h5>
            <p class="card-text">${product.shortDesc}</p>
            <p class="card-text text-danger fw-bold">$${product.price} <span class="text-muted text-decoration-line-through">$${product.oldPrice}</span></p>
            <button class="btn btn-sm btn-outline-primary" onclick='addToCart(${product.id})'>أضف إلى السلة</button>
            <button class="btn btn-sm btn-link" onclick='showProductPopup(${product.id})'>عرض التفاصيل</button>
          </div>
        </div>`;
      container.appendChild(card);
    });
  }

  function setFilter(filter) {
    currentFilter = filter;
    displayProducts();
  }

  function addToCart(id) {
    const product = products.find(p => p.id === id);
    const existing = cart.find(item => item.id === product.id);
    if (existing) {
      existing.quantity++;
    } else {
      cart.push({ ...product, quantity: 1 });
    }
    updateCart();
  }

  function updateCart() {
    document.getElementById('cart-count').textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
    const list = document.getElementById('cart-items');
    list.innerHTML = '';
    list.style.maxHeight = cart.length > 5 ? '250px' : 'auto';
    list.style.overflowY = cart.length > 5 ? 'auto' : 'visible';

    let totalItems = 0;
    let totalPrice = 0;

    cart.forEach((item, index) => {
      totalItems += item.quantity;
      totalPrice += item.price * item.quantity;

      const li = document.createElement('li');
      li.className = 'list-group-item d-flex align-items-center justify-content-between';
      li.innerHTML = `
        <img src="${item.images[0]}" style="width: 40px; height: 40px; object-fit: cover; margin-left: 10px;">
        <span class="flex-grow-1">${item.name} × ${item.quantity}</span>
        <span class="me-2">$${item.price * item.quantity}</span>
        <button class="btn btn-sm btn-danger" onclick="removeFromCart(${index})">×</button>`;
      list.appendChild(li);
    });

    const summary = document.createElement('li');
    summary.className = 'list-group-item d-flex justify-content-between bg-light fw-bold';
    summary.innerHTML = `<span>المجموع (${totalItems} منتج)</span><span>$${totalPrice}</span>`;
    list.appendChild(summary);
  }

  function removeFromCart(index) {
    if (cart[index].quantity > 1) {
      cart[index].quantity--;
    } else {
      cart.splice(index, 1);
    }
    updateCart();
  }

  function toggleCartPopup() {
    const popup = document.getElementById('cart-popup');
    popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
  }

  function showProductPopup(id) {
    currentProduct = products.find(p => p.id === id);
    document.getElementById('popup-title').textContent = currentProduct.name;
    document.getElementById('popup-description').textContent = currentProduct.description;
    document.getElementById('popup-price').textContent = `$${currentProduct.price} (كان $${currentProduct.oldPrice})`;

    const imageContainer = document.getElementById('popup-images');
    imageContainer.innerHTML = currentProduct.images.map(img => `<img src="${img}" alt="">`).join('');

    document.getElementById('product-popup').style.display = 'block';
  }

  function addToCartFromPopup() {
    if (currentProduct) {
      addToCart(currentProduct.id);
      closePopup('product-popup');
    }
  }

  function closePopup(id) {
    document.getElementById(id).style.display = 'none';
  }

  function showCheckoutPopup() {
    closePopup('cart-popup');
    document.getElementById('checkout-popup').style.display = 'block';
  }
  // let map, marker;
  // function initMap() {
  //   const defaultLocation = { lat: 31.963158, lng: 35.930359 };
  //   map = new google.maps.Map(document.getElementById("map"), {
  //     center: defaultLocation,
  //     zoom: 13,
  //   });
  //   map.addListener("click", function (e) {
  //     placeMarker(e.latLng);
  //   });
  // }
  // function placeMarker(location) {
  //   if (marker) {
  //     marker.setPosition(location);
  //   } else {
  //     marker = new google.maps.Marker({ position: location, map: map });
  //   }
  //   const lat = location.lat();
  //   const lng = location.lng();
  //   const mapLink = `https://maps.google.com/?q=${lat},${lng}`;
  //   document.getElementById('address').value = mapLink;
  // }
  // function getUserLocation() {
  //   if (!navigator.geolocation) {
  //     alert("متصفحك لا يدعم خاصية تحديد الموقع.");
  //     return;
  //   }
  //   navigator.geolocation.getCurrentPosition(
  //     function (position) {
  //       document.getElementById('location-error').style.display = 'none';
  //       const lat = position.coords.latitude;
  //       const lng = position.coords.longitude;
  //       const location = new google.maps.LatLng(lat, lng);
  //       map.setCenter(location);
  //       placeMarker(location);
  //     },
  //     function () {
  //       document.getElementById('location-error').style.display = 'block';
  //     }
  //   );
  // }
  function submitOrder() {
    const name = document.getElementById('name').value;
    const phone = document.getElementById('phone').value;
    const address = document.getElementById('address').value;
    const payment = document.getElementById('payment').value;

    
    if (name && phone && address && payment) {
      const orderItems = cart.map(i => `- ${i.name} × ${i.quantity} `).join('\n');
      const total = cart.reduce((sum, i) => sum + i.price * i.quantity, 0) + ' د.أ';
const message = `مرحبا، اسمي ${name}. أرغب بطلب:


${orderItems}



المجموع: ${total}
الهاتف: ${phone}
العنوان: ${address}
الدفع: ${payment}`;      const whatsappURL = `https://wa.me/962781313782?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank');
      cart.length = 0;
      updateCart();
      closePopup('checkout-popup');
    }
  }

  displayProducts();
</script>
</body>
</html>
